
<!DOCTYPE html>
<html lang="en">
<head>
  
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

  <meta http-equiv="Cache-Control" content="public" />
 
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.80.0" />

    
    
    

<title>basic rgee - Consideration • rgee Theme</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="basic rgee - Consideration"/>
<meta name="twitter:description" content="Thanks to reticulate embedding a Python session within an R session, rgee and the Earth Engine Python API share the same modules, classes, functions, and methods. In other words, the logic of the syntax is the same and just as fast (just change . by a $). Notwithstanding, differences in the language design of R and Python might cause some problems in specific scenarios. We identify three bug-potential cases."/>

<meta property="og:title" content="basic rgee - Consideration" />
<meta property="og:description" content="Thanks to reticulate embedding a Python session within an R session, rgee and the Earth Engine Python API share the same modules, classes, functions, and methods. In other words, the logic of the syntax is the same and just as fast (just change . by a $). Notwithstanding, differences in the language design of R and Python might cause some problems in specific scenarios. We identify three bug-potential cases." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://r-earthengine.github.io/intro_02/" />
<meta property="article:published_time" content="2020-01-06T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-01-06T00:00:00+00:00" /><meta property="og:site_name" content="rgee Theme" />



<link rel="canonical" href="https://r-earthengine.github.io/intro_02/" />

<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<link rel="icon" href="/favicon.ico" type="image/x-icon">





<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Allerta+Stencil">

<link rel="stylesheet" href="/css/w3.css" />


<link rel="stylesheet" href="/css/style.css" />

<link rel="stylesheet" href="/css/highlightjs/default.css" />
<link rel="stylesheet" href="/css/highlightjs/textmate.css" />

<link rel="stylesheet" href="/css/bootstrap/bootstrap.min.css" />



<script src="/js/highlightjs/highlight.js"></script>

<script src="/js/navigation/codefolding.js"></script>
<script src="/js/navigation/sourceembed.js"></script>
<script src="/js/navigation/tabsets.js"></script>

<script src="/js/navigation/bootstrap.min.js"></script>
<script src="/js/navigation/html5shiv.min.js"></script>
<script src="/js/navigation/respond.min.js"></script>


<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<script>

function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>



<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>


<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>



<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>








  
  
</head>
<body class="w3-light-grey">


    
    <header id="header">
         
        <div class="w3-right ">
<div class="w3-bar w3-light-grey  ">
  

  
      <span class="w3-hide-small">

      </span>
  
</div>
</div>
<br><br><br><br>
  <div class="w3-content">  
  <div class="w3-container w3-center w3-padding-32 w3-hide-small">
      <div class="rgee-text-wrapper">
      <a href="https://r-spatial.github.io/rgee/">
      <img src=https://user-images.githubusercontent.com/16768318/103302656-6af99c00-4a04-11eb-99ec-4dea22afa5ee.png alt="logo" class="rgee-img-responsive"></img>
      </a>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="rgee-svg"><path d="M18 2l6 10.5-6 10.5h-12l-6-10.5 6-10.5z"/></svg>    
      </div>         
      <br><br><br><br><br>   
      <h1 class="rgee-title">
        
          Google Earth Engine with R
        
      </h1>
      
    </div>
    <div class="w3-content w3-center">
    <div class="w3-bar w3-light-grey w3-border">
    <a href="/" class="w3-bar-item w3-button w3-large w3-green"><i class="fa fa-home"></i></a>
    
      <a href="/categories/" class="w3-bar-item w3-button w3-hide-small">Categories</a>
    
      <a href="/tags/" class="w3-bar-item w3-button w3-hide-small">Tags</a>
    
      <a href="/allposts/" class="w3-bar-item w3-button w3-hide-small">All Posts</a>
    
   
    
    <a href="javascript:void(0)" class="w3-bar-item w3-button w3-right w3-hide-large w3-hide-medium" onclick="displaymenu()">&#9776;</a>
  </div>

<div id="mobilemenu" class="w3-bar-block w3-light-grey w3-hide w3-hide-large w3-hide-medium">
  
      <a href="/categories/" class="w3-bar-item w3-button">Categories</a>
      
      <a href="/tags/" class="w3-bar-item w3-button">Tags</a>
      
      <a href="/allposts/" class="w3-bar-item w3-button">All Posts</a>
      
  
</div>
</div>
</div>
<script>
function displaymenu() {
    var x = document.getElementById("mobilemenu");
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else { 
        x.className = x.className.replace(" w3-show", "");
    }
}
</script>



    
    <hr class="headfoot">
   
      
    </header>
    
<div class="w3-content">
    
      <div>
        
        <div id="content" >
          
    

 
     


  <div class="w3-content w3-card-4" >
    
    <header class="w3-container w3-center w3-padding-32">
      <h1>basic rgee - Consideration</h1>

      <div >
        <p> 2020-01-06 
          
             <code> 674 words  </code>
             <code> 4 mins read </code>
          
        </p>
        <div >
            
              <a class="w3-btn w3-small w3-round w3-green" href="/categories/introduction/"> introduction </a>
            
          </div>
       
        
      </div>
    </header>

   
    
    <div class="w3-container">
      
        

        
        

        
          
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<script src="/rmarkdown-libs/clipboard/clipboard.min.js"></script>
<link href="/rmarkdown-libs/primer-tooltips/build.css" rel="stylesheet" />
<link href="/rmarkdown-libs/klippy/css/klippy.min.css" rel="stylesheet" />
<script src="/rmarkdown-libs/klippy/js/klippy.min.js"></script>


<p>Thanks to <strong>reticulate</strong> embedding a Python session within an R session, <strong>rgee</strong> and the <a href="https://pypi.org/project/earthengine-api/">Earth Engine Python
API</a> <strong>share the same modules, classes, functions, and methods</strong>. In other words, the logic of the syntax is the same and just as fast (just change <strong>.</strong> by a <strong>$</strong>). Notwithstanding, differences in the language design of R and Python might cause some problems in specific scenarios. We identify <strong>three</strong> bug-potential cases. Each of them are explained in-depth below.</p>
<script>
  addClassKlippyToPreCode();
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Click to copy', 'Done');
</script>
<div id="the-map-message-error" class="section level2">
<h2>1. The <strong>map</strong> message error:</h2>
<p>This issue happens when the <strong>map</strong> method is used
under the next two cases: (1) users employing a reticulate version
lower than &lt; 1.14 (please update it!); and (2) if you are leading
with <strong>ee$List</strong> objects. For instance:</p>
<pre class="r"><code>library(rgee)
ee$Initialize()
mylist = ee$List$sequence(10)
mylist$map(function(x) ee$Number(x)$add(1))
#&gt; Error in py_call_impl(callable, dots$args, dots$keywords): RuntimeError: Evaluation error: argument &quot;x&quot; is missing, with no default.
#&gt; 
#&gt; Detailed traceback: 
#&gt;   File &quot;/home/aybarpc01/.virtualenvs/r-reticulate/lib/python3.7/site-packages/ee/apifunction.py&quot;, line 205, in &lt;lambda&gt;
#&gt;     return lambda *args, **kwargs: func.call(*args, **kwargs)  # pylint: disable=unnecessary-lambda
#&gt;   File &quot;/home/aybarpc01/.virtualenvs/r-reticulate/lib/python3.7/site-packages/ee/function.py&quot;, line 67, in call
#&gt;     return self.apply(self.nameArgs(args, kwargs))
#&gt;   File &quot;/home/aybarpc01/.virtualenvs/r-reticulate/lib/python3.7/site-packages/ee/function.py&quot;, line 80, in apply
#&gt;     result = computedobject.ComputedObject(self, self.promoteArgs(named_args))
#&gt;   File &quot;/home/aybarpc01/.virtualenvs/r-reticulate/lib/python3.7/site-packages/ee/function.py&quot;, line 107, in promoteArgs
#&gt;     promoted_args[name] = Function._promoter(args[name], spec[&#39;type&#39;])
#&gt;   File &quot;/home/aybarpc01/.virtualenvs/r-reticulate/lib/python3.7/site-packages/ee/__init__.py&quot;, line 242, in _Promote
#&gt;     return CustomFunction.create(arg, &#39;Object&#39;, [&#39;Object&#39;] * args_count)
#&gt;   File &quot;/home/aybarpc01/.virtualenvs/r-reticulate/lib/python3.7/site-packages/ee/customfunction.py&quot;, line 121, in create
#&gt;     return CustomFunction(signature, func)
#&gt;   File &quot;/home/aybarpc01/.virtualenvs/r-reticulate/lib/python3.7/site-packages/ee/customfunction.py&quot;, line 47, in __init__
#&gt;     self._body = body(*variables)
#&gt;   File &quot;/home/aybarpc01/R/x86_64-pc-linux-gnu-library/3.6/reticulate/python/rpytools/call.py&quot;, line 21, in python_function
#&gt;     raise RuntimeError(res[kErrorKey])</code></pre>
<p>The code before is perfectly valid but <code>rgee</code> will produce an error.
This problem should be easily solved by adding the function <strong>ee_utils_pyfunc</strong>.
It will permit to wrap R functions before to send it to <code>reticulate</code>. Let’s see:</p>
<pre class="r"><code>library(rgee)
ee$Initialize()
mylist = ee$List$sequence(0,10)
mynewlist = mylist$map(
  ee_utils_pyfunc(
    function(x) ee$Number(x)$add(1)   
  )
)
mynewlist$getInfo()
#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11</code></pre>
<div id="do-not-forget-the-l" class="section level3">
<h3>2. Do not forget the <strong>L</strong></h3>
<p>By default, when you define a number in R it will produce a <strong>double
precision</strong> value. This does not happen in Python because, by default it
will create a <strong>int</strong> value.</p>
<p><strong>Python</strong></p>
<pre class="python"><code>type(1)
#&gt; &lt;class &#39;int&#39;&gt;</code></pre>
<p><strong>R</strong></p>
<pre class="r"><code>class(1)
#&gt; [1] &quot;numeric&quot;</code></pre>
<p>But why does this matter? Let’s explain it with an example:</p>
<p><strong>Python</strong></p>
<pre class="python"><code>ee.Initialize()
and_bitwise = ee.Number(32).bitwiseAnd(100)
and_bitwise.getInfo()
#&gt; 32</code></pre>
<p><strong>R</strong></p>
<pre class="r"><code>and_bitwise = ee$Number(32)$bitwiseAnd(100) #caution: silent error
and_bitwise$getInfo()
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;/home/aybarpc01/.local/lib/python3.7/site-packages/ee/computedobject.py&quot;, line 95, in getInfo
    return data.computeValue(self)
  File &quot;/home/aybarpc01/.local/lib/python3.7/site-packages/ee/data.py&quot;, line 490, in computeValue
    return send_(&#39;/value&#39;, ({&#39;json&#39;: obj.serialize(), &#39;json_format&#39;: &#39;v2&#39;}))
  File &quot;/home/aybarpc01/.local/lib/python3.7/site-packages/ee/data.py&quot;, line 1186, in send_
    raise ee_exception.EEException(json_content[&#39;error&#39;][&#39;message&#39;])
ee.ee_exception.EEException: Number.bitwiseAnd: Bitwise operands must be integer only.</code></pre>
<p>Users need to take into consideration that most of the arguments of the
Earth Engine methods are strict to admit only <strong>integer values</strong>. The
creation of integers in R is quite simple, you just need to add the
letter <strong>L</strong> to the end of the specific number or employ the
function <code>as.integer</code>. The <strong>correct code</strong> in R would be:</p>
<pre class="r"><code>and_bitwise = ee$Number(32L)$bitwiseAnd(100L)
and_bitwise$getInfo()
#&gt; [1] 32</code></pre>
</div>
<div id="be-careful-with-eedate" class="section level3">
<h3>3. Be careful with <strong>ee$Date</strong></h3>
<p>This problem also appears due to differences between the design of R and
Python as programming languages. Currently, R only support integer data
type of 32 bits. Such integers can only count up to about 2 billion. Unfortunately,
this range is extremely insufficient to deal with <a href="https://developers.google.com/earth-engine/glossary">Google Earth
Engine timestamp</a>
which is saved in milliseconds since the <a href="https://en.wikipedia.org/wiki/Unix_time">UNIX epoch</a>.</p>
<p><strong>Python</strong></p>
<pre class="python"><code>my_date = ee.Date(&#39;1990-01-01&#39;)
my_date.getInfo()
#&gt; {&#39;type&#39;: &#39;Date&#39;, &#39;value&#39;: 631152000000} # greater than 2 billion</code></pre>
<p><strong>R</strong></p>
<pre class="r"><code>my_date &lt;- ee$Date(&#39;1990-01-01&#39;)
my_date$getInfo()
#&gt; $type
#&gt; [1] &quot;Date&quot;
#&gt; 
#&gt; $value
#&gt; [1] -208192512</code></pre>
<p>The problems with <code>ee$Date</code> just appear in the last mile (Python to R or
vice-versa, <code>reticulate</code>), and it should not be a trouble if treated
with care. <code>rgee</code> implement two functions to deal with Earth Engine
dates: <code>eedate_to_rdate</code> and <code>rdate_to_eedate</code>.</p>
<pre class="r"><code># Era5 dataset
era_img &lt;- ee$ImageCollection(&quot;ECMWF/ERA5/DAILY&quot;)$
  filterDate(&quot;2019-01-01&quot;, &quot;2019-12-31&quot;)$
  first()
# Extracting init date
ee_date &lt;- era_img$get(&#39;system:time_start&#39;)
ee_date$getInfo() # Silent error
#&gt; [1] 112573440
eedate_to_rdate(ee_date = ee_date, timestamp = TRUE)
#&gt; [1] 1.546301e+12</code></pre>
</div>
</div>

                 
                
         
      
    </div>

    
   

    <div class="w3-container">
    	
      <div class="w3-container">
        	<hr class = "tag">
        Tags: 
          
          <a class="w3-btn w3-small w3-round w3-green" href="/tags/map/">map</a>
          
          <a class="w3-btn w3-small w3-round w3-green" href="/tags/eedate_to_rdate/">eedate_to_rdate</a>
          
          <a class="w3-btn w3-small w3-round w3-green" href="/tags/rdate_to_eedate/">rdate_to_eedate</a>
          
          <hr class = "tag">
       
        </div>
     
	</div>



  


    
    
    
    
    <br>  
</div>



<div class="w3-container w3-card-2 w3-black">
<div class="w3-row">
  <div class="w3-col l2 m2 s12 w3-center">
  
    <img src="https://user-images.githubusercontent.com/16768318/103300162-895c9900-49fe-11eb-9b6e-eac9b6d9b132.png" width ="100px" class="w3-circle w3-center w3-margin-top w3-margin-bottom" alt="author" >
   
  </div>
  <div class="w3-col l10 m10 s12 ">
  <div class = "w3-container w3-margin-top">
    Cesar Aybar
    <p class="w3-small"><strong>This article is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/" class="w3-text-white">Creative Commons Attribution 4.0 International License</strong></a>.</p>
  </div>
  </div>
  </div>
</div>

      
    <div class="w3-content" > 
      <div class="w3-bar w3-section">
	     
	      <a  href="https://r-earthengine.github.io/intro_03/" class="w3-btn w3-text-indigo w3-hover-green">
	          &#10094; basic rgee - Best practices
	      </a>
	    
	      <a class="w3-btn w3-right w3-text-indigo w3-hover-green" href="https://r-earthengine.github.io/image_01/">
	       Image Overview &#10095;
	      </a>
  	  </div>
    </div>
	
 

  
  
      
      <script src="/js/w3codecolor-min.js"></script>

      <script>
      w3CodeColor();
      </script>
  

      <div id="wrapads">
        <div class="adBanner">
         
        </div>
       </div>
      
      <div id="allowads" class="allowads-overlay">
  
        <div class="allowads-overlay-content">
        <div class="w3-panel w3-pink w3-large">
        

         <p> We notice you're using an adblocker.  If you like our webite please keep us running by whitelisting this site in your ad blocker. We’re serving quality, related ads only. Thank you!</p>
         
          <div class="w3-btn w3-green"  onclick="closeOverlay()">I've whitelisted your website.</div><br>
          <div class="w3-button w3-small"  onclick="closeOverlay()">Not now</div>
        </div>
        </div>
      </div>

      <script>
      function closeOverlay() {
        document.getElementById("allowads").style.width = "0%";
        document.getElementById("wrapads").style.height="1px";
      }

      function detectads() {
      var h = document.getElementById("wrapads").clientHeight;

      if (h==0){ document.getElementById("allowads").style.width = "100%";
      }
      }
      

     
      
      </script>
        </div>
        
          <script>
  shareurl=encodeURIComponent(location.protocol + '//' + location.host + location.pathname);
  sharetitle=encodeURIComponent(document.title);
    
  </script>
<div class="icon-bar">
<script>
document.write( '<a href="javascript:bookmark();" class="bookmark w3-tooltip"><i class="fa fa-bookmark"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green ">Bookmark this page</span></a> ');

document.write( '<a href="http://www.facebook.com/sharer.php?u='+shareurl+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="facebook w3-tooltip"><i class="fa fa-facebook "></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Facebook</span></a> ');

document.write( '<a href="https://twitter.com/share?url='+shareurl+'&amp;text='+sharetitle+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="twitter w3-tooltip"><i class="fa fa-twitter"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Twitter</span></a> ');
document.write( '<a href="https://plus.google.com/share?url='+shareurl+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="google w3-tooltip"><i class="fa fa-google"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Google Plus</span></a>');

document.write( '<a href="http://www.linkedin.com/shareArticle?mini=true&amp;url='+shareurl+'" onclick="window.open(this.href, \'mywin\',\'left=20,top=20,width=500,height=500,toolbar=1,resizable=0\'); return false;" class="linkedin w3-tooltip"><i class="fa fa-linkedin"></i><span style="position:absolute;left:40px;bottom:18px" class="w3-text w3-small w3-tag w3-round w3-green">Share to Linkedin</span></a>');

</script>

<script>
function bookmark(){

if ('sidebar' in window && 'addPanel' in window.sidebar) { 
                window.sidebar.addPanel(location.href,document.title,"");
            } else if(  false) { 
                window.external.AddFavorite(location.href,document.title); 
            } else { 
                alert('Press ' + (navigator.userAgent.toLowerCase().indexOf('mac') != - 1 ? 'Command/Cmd' : 'CTRL') + ' + D to bookmark this page.');
            }
        }

</script>
</div>
        
           
          
  <div id="disqus_thread"></div>
    <script type="text/javascript">
    (function() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'http-r-earthengine-github-io';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

        
        
      </div>
    

   
    <footer id="footer" >
      <div class="w3-container w3-center w3-padding-32"> 
  
  <hr class="headfoot">
  <p>Powered by <a href="https://gohugo.io">Hugo</a> | Theme - <a href="https://github.com/jesselau76/hugo-w3-simple">Hugo W3 Simple</a>
  </p>
  © <a href="https://github.com/r-spatial/rgee">rgee</a> 2020 | <a href="https://github.com/csaybar">Github</a> | <a href="https://twitter.com/talk_rspatial">Twitter</a>  | <a href="/index.xml">RSS</a>
  
</div>

    </footer>
    

    
  </div>

   
  <div id="cookiebar" class="w3-bar w3-top w3-black w3-border   " >
  
  <span class="w3-bar-item w3-small">This website uses cookies to ensure you get the best experience on our website. <a href="/privacy-policy/">Learn more</a></span>
  <span onclick="gotitcookiebar()"
  class="w3-button w3-small w3-green w3-right">Got it</span>
   </div>

    
<script>
function gotitcookiebar() {
    var x =document.getElementById("cookiebar");
    x.style.display = "none";
var x = document.getElementsByTagName("BODY")[0];
    x.style.paddingTop = "0px";
    

}


    
function checkCookie() {
    var user=getCookie("cookiebardisplayed");
    if (user == "") {
      setCookie("cookiebardisplayed","0",365);}

    user=getCookie("cookiebardisplayed");
    if (user =="0")
    {

        var x =document.getElementById("cookiebar");
    x.style.display = "block";
    var h = document.getElementById('cookiebar').clientHeight;
    
    var x = document.getElementsByTagName("BODY")[0];
    x.style.paddingTop = h+"px";
    setCookie("cookiebardisplayed","1",365);
    } 
    
}
function setCookie(cname,cvalue,exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires=" + d.toGMTString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
    var name = cname + "=";
    var decodedCookie = decodeURIComponent(document.cookie);
    var ca = decodedCookie.split(';');
    for(var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}
document.addEventListener('DOMContentLoaded', function() {
    checkCookie();
}, false);

</script>   


  
    
      <div id="backtotop" class="w3-hide-small w3-hide-medium">
  
        <button onclick="topFunction()" class="w3-btn w3-red w3-large" style="width:160px">Back To Top
        &rarr;</button>
        
      </div>

      <script>
        function topFunction() {
          document.body.scrollTop = 0;
          document.documentElement.scrollTop = 0;
      }
      </script>


    
 
    
    <script>
    
    function isVisible(elem) {

      let coords = elem.getBoundingClientRect();

      let windowHeight = document.documentElement.clientHeight;

      
      let topVisible = coords.top > 0 && coords.top < windowHeight;
      let bottomVisible = coords.bottom < windowHeight && coords.bottom > 0;

      return topVisible || bottomVisible;
    }

    

    function showVisible() {
      for (let img of document.querySelectorAll('img')) {
        let realSrc = img.dataset.src;
        if (!realSrc) continue;

        if (isVisible(img)) {
          

          img.src = realSrc;

          img.dataset.src = '';
        }
      }
      if ( Array.from(document.querySelectorAll('[data-src]')).every(
        img => img.getAttribute('data-src') === '') ) {
        window.removeEventListener('scroll', showVisible)
      }

    }

    window.addEventListener('scroll', showVisible);
    showVisible();
  </script>


    
    
      <div class="progress-container" id="scrollbar">
        <div class="progress-bar" id="progress-bar"></div>
      </div>  


    
<script>

window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  <!-- TOC -->
    
    
    
    <!-- cookie bar -->
    
    if (document.body.scrollTop > 50 || document.documentElement.scrollTop > 50) {
        var x =document.getElementById("cookiebar");
        x.style.display = "none";
        var x = document.getElementsByTagName("BODY")[0];
        x.style.paddingTop = "0px";

    } 
    
<!-- Back to top -->
    
    if (document.body.scrollTop > 50 || document.documentElement.scrollTop > 50) {
        document.getElementById("backtotop").style.display = "block";
    } else {
        document.getElementById("backtotop").style.display = "none";
    }
    
    <!-- scroll indicator -->
    
      var winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      var height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      var scrolled = (winScroll / height) * 100;
      document.getElementById("progress-bar").style.width = scrolled + "%";
      if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            document.getElementById("scrollbar").style.display = "block";
        } else {
            document.getElementById("scrollbar").style.display = "none";
        }
    

    

    <!-- allowads -->
    
       if (document.body.scrollTop > 2000 || document.documentElement.scrollTop > 2000) {
          detectads();
       } 

    
}


</script>



  

</body>
</html>
